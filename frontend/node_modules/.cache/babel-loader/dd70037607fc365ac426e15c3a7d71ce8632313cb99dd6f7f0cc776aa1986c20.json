{"ast":null,"code":"import _slicedToArray from\"/Users/akshansh/workspace/Minor II/TravBook/reactjs-tours-travels-booking/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/akshansh/workspace/Minor II/TravBook/reactjs-tours-travels-booking/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/akshansh/workspace/Minor II/TravBook/reactjs-tours-travels-booking/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React,{useState,useEffect,useContext}from'react';import{AuthContext}from'../context/AuthContext.js';import'../styles/profile.css';import{BASE_URL}from'../utils/config.js';import TourCard from'../shared/TourCard.jsx';import'../shared/tour-card.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Profile=function Profile(){var _useContext=useContext(AuthContext),user=_useContext.user;var BookingCard=function BookingCard(_ref){var booking=_ref.booking;return/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#faa935'},className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-title\",children:booking.tourName}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text\",children:[\"Guests: \",booking.guestSize]}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text\",children:[\"Date: \",new Date(booking.bookAt).toLocaleDateString()]})]})});};var deleteTour=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(tour){var res,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(BASE_URL,\"/delete/\").concat(tour._id),{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \".concat(localStorage.getItem('token'))}});case 3:res=_context.sent;_context.next=6;return res.json();case 6:result=_context.sent;fetchTours();if(res.ok){_context.next=10;break;}return _context.abrupt(\"return\",alert(result.message));case 10:alert(result.message);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);alert(_context.t0.message);case 16:case\"end\":return _context.stop();}},_callee,null,[[0,13]]);}));return function deleteTour(_x){return _ref2.apply(this,arguments);};}();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),bookings=_useState2[0],setBookings=_useState2[1];useEffect(function(){if(user){fetchBookings();}},[user]);var fetchBookings=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(\"\".concat(BASE_URL,\"/booking/\").concat(user===null||user===void 0?void 0:user._id));case 3:response=_context2.sent;_context2.next=6;return response.json();case 6:data=_context2.sent;setBookings(data.reverse());_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.error('Failed to fetch expenses:',_context2.t0);case 13:case\"end\":return _context2.stop();}},_callee2,null,[[0,10]]);}));return function fetchBookings(){return _ref3.apply(this,arguments);};}();var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),tours=_useState4[0],setTours=_useState4[1];useEffect(function(){if(user){fetchTours();}},[user]);var fetchTours=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var response,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return fetch(\"\".concat(BASE_URL,\"/tours/provider/\").concat(user===null||user===void 0?void 0:user._id));case 3:response=_context3.sent;_context3.next=6;return response.json();case 6:data=_context3.sent;setTours(data.reverse());_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](0);console.error('Failed to fetch expenses:',_context3.t0);case 13:case\"end\":return _context3.stop();}},_callee3,null,[[0,10]]);}));return function fetchTours(){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Profile\"}),/*#__PURE__*/_jsx(\"div\",{className:\"whole-profile-info\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"profile-info\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://api.multiavatar.com/kathrin.svg\",alt:\"Profile Picture\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"h1\",{children:user.username}),/*#__PURE__*/_jsxs(\"h5\",{children:[\"Email: \",user.email]})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[user&&user.role===\"user\"&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"mt-5 mb-3\",children:\"Your Bookings:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"row row-cols-1 row-cols-md-3 g-4\",children:bookings&&bookings.map(function(booking,index){return/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsx(BookingCard,{booking:booking})},index);})})]}),user&&user.role===\"provider\"&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"mt-5 mb-3\",children:\"Your Tours:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"row row-cols-1 row-cols-md-3 g-4\",children:tours&&tours.map(function(tour,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[/*#__PURE__*/_jsx(TourCard,{tour:tour}),/*#__PURE__*/_jsx(\"button\",{className:\" booking__btn\",onClick:function onClick(){return deleteTour(tour);},children:\"Delete\"})]},index);})})]})]})]});};export default Profile;","map":{"version":3,"names":["React","useState","useEffect","useContext","AuthContext","BASE_URL","TourCard","Profile","user","BookingCard","booking","backgroundColor","tourName","guestSize","Date","bookAt","toLocaleDateString","deleteTour","tour","fetch","_id","method","headers","localStorage","getItem","res","json","result","fetchTours","ok","alert","message","bookings","setBookings","fetchBookings","response","data","reverse","console","error","tours","setTours","username","email","role","map","index"],"sources":["/Users/akshansh/workspace/Minor II/TravBook/reactjs-tours-travels-booking/frontend/src/pages/Profile.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\nimport { AuthContext } from '../context/AuthContext.js'\nimport '../styles/profile.css'\nimport { BASE_URL } from '../utils/config.js'\nimport TourCard from '../shared/TourCard.jsx'\nimport '../shared/tour-card.css'\n\nconst Profile = () => {\n  const { user } = useContext(AuthContext);\n\n  const BookingCard = ({ booking }) => {\n    return (\n      <div style={{ backgroundColor: '#faa935' }} className=\"card\">\n        <div className=\"card-body\">\n          <h5 className=\"card-title\">{booking.tourName}</h5>\n          <p className=\"card-text\">Guests: {booking.guestSize}</p>\n          <p className=\"card-text\">Date: {new Date(booking.bookAt).toLocaleDateString()}</p>\n        </div>\n      </div>\n    );\n  };\n\n\n  const deleteTour = async (tour) => {\n    try {\n      const res = await fetch(`${BASE_URL}/delete/${tour._id}`, {\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      const result = await res.json();\n      fetchTours();\n      if (!res.ok) {\n        return alert(result.message);\n      }\n      alert(result.message);\n    } catch (error) {\n      alert(error.message);\n    }\n  };\n\n  const [bookings, setBookings] = useState(null);\n  useEffect(() => {\n    if (user) {\n      fetchBookings();\n    }\n  }, [user]);\n\n  const fetchBookings = async () => {\n    try {\n      const response = await fetch(`${BASE_URL}/booking/${user?._id}`);\n      const data = await response.json();\n      setBookings(data.reverse());\n    } catch (error) {\n      console.error('Failed to fetch expenses:', error);\n    }\n  };\n\n  const [tours, setTours] = useState(null);\n  useEffect(() => {\n    if (user) {\n      fetchTours();\n    }\n  }, [user]);\n\n  const fetchTours = async() => {\n    try {\n      const response = await fetch(`${BASE_URL}/tours/provider/${user?._id}`);\n      const data = await response.json();\n      setTours(data.reverse());\n    } catch (error) {\n      console.error('Failed to fetch expenses:', error);\n    }\n  };\n\n  return (\n    <div>\n      <div className=\"container\">\n        <h2>User Profile</h2>\n        <div className='whole-profile-info'>\n          <div className=\"profile-info\">\n            <img src=\"https://api.multiavatar.com/kathrin.svg\" alt=\"Profile Picture\" />\n            <div className='info'>\n              <h1>{user.username}</h1>\n              <h5>Email: {user.email}</h5>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className=\"container\">\n      {user && user.role === \"user\" && (\n        <div>\n        <h3 className=\"mt-5 mb-3\">Your Bookings:</h3>\n      \n        <div className=\"row row-cols-1 row-cols-md-3 g-4\">\n          {bookings && bookings.map((booking, index) => (\n            <div className=\"col\" key={index}>\n              <BookingCard booking={booking} />\n            </div>\n          ))}\n        </div>\n        </div>\n        )}\n        {user && user.role === \"provider\" && (\n        <div>\n        <h3 className=\"mt-5 mb-3\">Your Tours:</h3>\n      \n        <div className=\"row row-cols-1 row-cols-md-3 g-4\">\n          {tours && tours.map((tour, index) => (\n            <div className=\"col\" key={index}>\n              <TourCard tour={tour} />\n              <button className=' booking__btn' onClick={() => deleteTour(tour)}>Delete</button>\n            </div>\n          ))}\n        </div>\n        </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Profile;"],"mappings":"wgBAAA,MAAOA,MAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,UAAU,KAAQ,OAAO,CAC9D,OAASC,WAAW,KAAQ,2BAA2B,CACvD,MAAO,uBAAuB,CAC9B,OAASC,QAAQ,KAAQ,oBAAoB,CAC7C,MAAOC,SAAQ,KAAM,wBAAwB,CAC7C,MAAO,yBAAyB,yFAEhC,GAAMC,QAAO,CAAG,QAAVA,QAAO,EAAS,CACpB,gBAAiBJ,UAAU,CAACC,WAAW,CAAC,CAAhCI,IAAI,aAAJA,IAAI,CAEZ,GAAMC,YAAW,CAAG,QAAdA,YAAW,MAAoB,IAAdC,QAAO,MAAPA,OAAO,CAC5B,mBACE,YAAK,KAAK,CAAE,CAAEC,eAAe,CAAE,SAAU,CAAE,CAAC,SAAS,CAAC,MAAM,uBAC1D,aAAK,SAAS,CAAC,WAAW,wBACxB,WAAI,SAAS,CAAC,YAAY,UAAED,OAAO,CAACE,QAAQ,EAAM,cAClD,WAAG,SAAS,CAAC,WAAW,WAAC,UAAQ,CAACF,OAAO,CAACG,SAAS,GAAK,cACxD,WAAG,SAAS,CAAC,WAAW,WAAC,QAAM,CAAC,GAAIC,KAAI,CAACJ,OAAO,CAACK,MAAM,CAAC,CAACC,kBAAkB,EAAE,GAAK,GAC9E,EACF,CAEV,CAAC,CAGD,GAAMC,WAAU,6FAAG,iBAAOC,IAAI,wKAERC,MAAK,WAAId,QAAQ,oBAAWa,IAAI,CAACE,GAAG,EAAI,CACxDC,MAAM,CAAE,QAAQ,CAChBC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,eAAe,kBAAYC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC1D,CACF,CAAC,CAAC,QANIC,GAAG,qCAOYA,IAAG,CAACC,IAAI,EAAE,QAAzBC,MAAM,eACZC,UAAU,EAAE,CAAC,GACRH,GAAG,CAACI,EAAE,0DACFC,KAAK,CAACH,MAAM,CAACI,OAAO,CAAC,UAE9BD,KAAK,CAACH,MAAM,CAACI,OAAO,CAAC,CAAC,iFAEtBD,KAAK,CAAC,YAAMC,OAAO,CAAC,CAAC,oEAExB,kBAlBKd,WAAU,6CAkBf,CAED,cAAgChB,QAAQ,CAAC,IAAI,CAAC,wCAAvC+B,QAAQ,eAAEC,WAAW,eAC5B/B,SAAS,CAAC,UAAM,CACd,GAAIM,IAAI,CAAE,CACR0B,aAAa,EAAE,CACjB,CACF,CAAC,CAAE,CAAC1B,IAAI,CAAC,CAAC,CAEV,GAAM0B,cAAa,6FAAG,mMAEKf,MAAK,WAAId,QAAQ,qBAAYG,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEY,GAAG,EAAG,QAA1De,QAAQ,uCACKA,SAAQ,CAACT,IAAI,EAAE,QAA5BU,IAAI,gBACVH,WAAW,CAACG,IAAI,CAACC,OAAO,EAAE,CAAC,CAAC,qFAE5BC,OAAO,CAACC,KAAK,CAAC,2BAA2B,cAAQ,CAAC,sEAErD,kBARKL,cAAa,2CAQlB,CAED,eAA0BjC,QAAQ,CAAC,IAAI,CAAC,yCAAjCuC,KAAK,eAAEC,QAAQ,eACtBvC,SAAS,CAAC,UAAM,CACd,GAAIM,IAAI,CAAE,CACRoB,UAAU,EAAE,CACd,CACF,CAAC,CAAE,CAACpB,IAAI,CAAC,CAAC,CAEV,GAAMoB,WAAU,6FAAG,mMAEQT,MAAK,WAAId,QAAQ,4BAAmBG,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEY,GAAG,EAAG,QAAjEe,QAAQ,uCACKA,SAAQ,CAACT,IAAI,EAAE,QAA5BU,IAAI,gBACVK,QAAQ,CAACL,IAAI,CAACC,OAAO,EAAE,CAAC,CAAC,qFAEzBC,OAAO,CAACC,KAAK,CAAC,2BAA2B,cAAQ,CAAC,sEAErD,kBARKX,WAAU,2CAQf,CAED,mBACE,oCACE,aAAK,SAAS,CAAC,WAAW,wBACxB,oBAAI,cAAY,EAAK,cACrB,YAAK,SAAS,CAAC,oBAAoB,uBACjC,aAAK,SAAS,CAAC,cAAc,wBAC3B,YAAK,GAAG,CAAC,yCAAyC,CAAC,GAAG,CAAC,iBAAiB,EAAG,cAC3E,aAAK,SAAS,CAAC,MAAM,wBACnB,oBAAKpB,IAAI,CAACkC,QAAQ,EAAM,cACxB,sBAAI,SAAO,CAAClC,IAAI,CAACmC,KAAK,GAAM,GACxB,GACF,EACF,GACF,cACN,aAAK,SAAS,CAAC,WAAW,WACzBnC,IAAI,EAAIA,IAAI,CAACoC,IAAI,GAAK,MAAM,eAC3B,oCACA,WAAI,SAAS,CAAC,WAAW,UAAC,gBAAc,EAAK,cAE7C,YAAK,SAAS,CAAC,kCAAkC,UAC9CZ,QAAQ,EAAIA,QAAQ,CAACa,GAAG,CAAC,SAACnC,OAAO,CAAEoC,KAAK,qBACvC,YAAK,SAAS,CAAC,KAAK,uBAClB,KAAC,WAAW,EAAC,OAAO,CAAEpC,OAAQ,EAAG,EADToC,KAAK,CAEzB,EACP,CAAC,EACE,GAEL,CACAtC,IAAI,EAAIA,IAAI,CAACoC,IAAI,GAAK,UAAU,eACjC,oCACA,WAAI,SAAS,CAAC,WAAW,UAAC,aAAW,EAAK,cAE1C,YAAK,SAAS,CAAC,kCAAkC,UAC9CJ,KAAK,EAAIA,KAAK,CAACK,GAAG,CAAC,SAAC3B,IAAI,CAAE4B,KAAK,qBAC9B,aAAK,SAAS,CAAC,KAAK,wBAClB,KAAC,QAAQ,EAAC,IAAI,CAAE5B,IAAK,EAAG,cACxB,eAAQ,SAAS,CAAC,eAAe,CAAC,OAAO,CAAE,yBAAMD,WAAU,CAACC,IAAI,CAAC,EAAC,UAAC,QAAM,EAAS,GAF1D4B,KAAK,CAGzB,EACP,CAAC,EACE,GAEL,GACG,GACF,CAEV,CAAC,CAED,cAAevC,QAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}